<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Neural Speech Enhancement | Nicholas W. Reeves </title> <meta name="author" content="Nicholas W. Reeves"> <meta name="description" content="Removing background noise and echos from noisy audio files"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://n-reeves.github.io/projects/Neural-Speech-Enhancement/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Nicholas</span> W. Reeves </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">Blog </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/resume/">Resume </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Neural Speech Enhancement</h1> <p class="post-description">Removing background noise and echos from noisy audio files</p> </header> <article> <p>This interactive demo showcases a neural network I designed to enhance multi-speaker audio. The system was trained to reduce background noise and reverberation in low-resolution audio files. The project demonstrates the complete deep learning development process, including model architecture design, training procedures, pre/post-processing (with custom signal processing algorithms), MLOps infrastructure, and web development.</p> <p>Due to limited computational resources, the system was trained for only eight hours on five gigabytes of data, focusing on low-fidelity audio. Despite the short training time and small dataset, the network successfully delivers the intended results in a wide range of real-world audio scenarios.</p> <p>Further details about the audio processing can be found in a <a href="https://n-reeves.github.io/blog/2025/speech-enhancement-network/">separate blog post</a>. The repository for the inference pipeline can be found <a href="https://github.com/n-reeves/speech-enhancement-endpoint" rel="external nofollow noopener" target="_blank">here</a>. The repository that contains the full model architecure is <a href="https://github.com/n-reeves/source-separation" rel="external nofollow noopener" target="_blank">here</a>.</p> <h1 id="file-upload">File Upload</h1> <p>Upload a <em>.mp3, .flac, .wav</em> file below. File length is capped at thirty seconds and lowered in quality to help manage cost</p> <div> <input type="file" id="upload" accept=".mp3, .wav, .flac"> <div id="error" style="color: red; margin-top: 10px;"></div> <audio id="input-audio" controls="" style="display: none; margin-top: 10px;"></audio> <a id="input-download" style="display: none; margin-top: 10px;">Download Resampled Audio</a> </div> <script>
//event listener for upload button
document.getElementById('upload').addEventListener('change', function (event) {
    const file = event.target.files[0];
    const errorElement = document.getElementById('error');
    const inputAudioPlayer = document.getElementById('input-audio');
    const outputAudioPlayer = document.getElementById('output-audio');
    const enhanceButton = document.getElementById('enhance-button');

    if (!file) return;

    const audioObjectUrl = URL.createObjectURL(file);
    const tempAudio = new Audio(audioObjectUrl);

    // Revoke old src if it exists
    if (inputAudioPlayer.src) {
        URL.revokeObjectURL(inputAudioPlayer.src);
        inputAudioPlayer.src = ''; // Clear previous src
        inputAudioPlayer.style.display = 'none';
        enhanceButton.disabled = true;
    }
    
    tempAudio.addEventListener('loadedmetadata', async function () {
        // Check the duration of the file
        const duration = tempAudio.duration;

        if (duration > 30.5) {
            errorElement.textContent = `Error: File length is longer than 30 seconds. Uploaded file is ${duration} seconds.`;
            URL.revokeObjectURL(audioObjectUrl);
        } else {
            try {
                const resampledAudioURL = await resampleAudio(file);
                URL.revokeObjectURL(audioObjectUrl);

                inputAudioPlayer.src = resampledAudioURL;
                inputAudioPlayer.style.display = 'block';

                enhanceButton.disabled = false;
                //enhanceButton.value = 'asdaisodhjoaijsd';

                //errorElement.textContent = `${enhanceButton.disabled}`;
                errorElement.textContent = '';

            } catch (err) {
                errorElement.textContent = `Error processing the audio file. ${err}`;
                console.error(err);
            }
        }   
    });
});

async function resampleAudio(file) {
    const desiredSampleRate = 8000;
    const audioContext = new window.AudioContext();
    
     // Decode the audio file
    const arrayBuffer = await file.arrayBuffer();
    const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);

    // If the sample rate matches the desired rate, return the original buffer
    if (audioBuffer.sampleRate === desiredSampleRate) {
        return URL.createObjectURL(file);
    }

    // Resample the audio
    const offlineContext = new OfflineAudioContext(
        audioBuffer.numberOfChannels,
        Math.ceil(audioBuffer.length * desiredSampleRate / audioBuffer.sampleRate),
        desiredSampleRate
    );
    const source = offlineContext.createBufferSource();
    source.buffer = audioBuffer;
    source.connect(offlineContext.destination);
    source.start();

    const resampledBuffer = await offlineContext.startRendering();

    // Encode the resampled buffer to a WAV file
    const wavBlob = encodeWAV(resampledBuffer);
    return URL.createObjectURL(wavBlob);
}

function encodeWAV(audioBuffer) {
    const numberOfChannels = audioBuffer.numberOfChannels;
    const length = audioBuffer.length * numberOfChannels;
    const sampleRate = audioBuffer.sampleRate;
    const buffer = new ArrayBuffer(44 + length * 2);
    const view = new DataView(buffer);

    // Write the WAV container header
    writeString(view, 0, 'RIFF');
    view.setUint32(4, 36 + length * 2, true);
    writeString(view, 8, 'WAVE');
    writeString(view, 12, 'fmt ');
    view.setUint32(16, 16, true);
    view.setUint16(20, 1, true);
    view.setUint16(22, numberOfChannels, true);
    view.setUint32(24, sampleRate, true);
    view.setUint32(28, sampleRate * 4, true);
    view.setUint16(32, numberOfChannels * 2, true);
    view.setUint16(34, 16, true);
    writeString(view, 36, 'data');
    view.setUint32(40, length * 2, true);

    // Write the PCM samples
    const offset = 44;
    const data = new Float32Array(audioBuffer.length * numberOfChannels);
    for (let channel = 0; channel < numberOfChannels; channel++) {
        audioBuffer.copyFromChannel(data.subarray(channel * audioBuffer.length, (channel + 1) * audioBuffer.length), channel);
    }
    for (let i = 0; i < data.length; i++) {
        const sample = Math.max(-1, Math.min(1, data[i]));
        view.setInt16(offset + i * 2, sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
    }

    return new Blob([buffer], { type: 'audio/wav' });
}

function writeString(view, offset, string) {
    for (let i = 0; i < string.length; i++) {
        view.setUint8(offset + i, string.charCodeAt(i));
    }
}
</script> <h1 id="enhance">Enhance</h1> <p>Click the enhance button to process the audio.</p> <div> <input id="enhance-button" type="button" value="Enhance" disabled> <div id="error-enhance" style="color: red; margin-top: 10px;"></div> <audio id="output-audio" controls="" style="display: none; margin-top: 10px;"></audio> <a id="output-download" style="display: none; margin-top: 10px;">Download Enhanced Audio</a> </div> <script>
document.getElementById('enhance-button').addEventListener('click', async function () {
    const inputAudioPlayer = document.getElementById('input-audio');
    const errorElementEnhance = document.getElementById('error-enhance');

    errorElementEnhance.textContent = "Enhance button clicked!"; // Debugging message

    if (!inputAudioPlayer.src) { 
        errorElementEnhance.textContent = "No audio source found!";
        return;
    }

    try {
        //check if api is up
        const testResponse = await fetch("https://humble-wrongly-bluebird.ngrok-free.app/ping");
        //const testResponse = await fetch("http://127.0.0.1:8000/ping");
        const testJsonResponse = await testResponse.json();

        if (testJsonResponse.error) {
            errorElementEnhance.textContent = `Error: ${testJsonResponse.error}`;
        } else {
            //if api is up, invocations
            errorElementEnhance.textContent = `Enhancement successful: ${testJsonResponse.message}`;
        }
    } catch (err) {
        errorElementEnhance.textContent = `Process Failed: ${err.message || err}`;
    }
});
</script> <h1 id="example">Example</h1> <p>Here is a preview of the system’s capability. There are clear aesthetic issues with the output, however it appears that background noise is being supressed and the speech content is largely preserved. It is unclear whether the system provides any perceptual advantage in output quality during noisy scenarios for individuals with hearing impairments in real-life situations.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <label for="input-audio-example">Input Audio Example</label> <figure> <audio src="/assets/audio/quiet-speech-loud-drone_in.wav" controls=""></audio> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <label for="output-audio-example">Output Audio Example</label> <figure> <audio src="/assets/audio/quiet-speech-loud-drone_out.wav" controls=""></audio> </figure> </div> </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/speech-enhance/speech-enhance-example-480.webp 480w,/assets/img/speech-enhance/speech-enhance-example-800.webp 800w,/assets/img/speech-enhance/speech-enhance-example-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/speech-enhance/speech-enhance-example.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Nicholas W. Reeves. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>